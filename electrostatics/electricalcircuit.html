<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../styles.css" rel="stylesheet">
    <title>Electrical Circuit Visualization</title>
</head>
<body onload="resetSimulation();initPage();">
    <nav></nav>
    <h1>Electrical Circuit Visualization</h1>
    <canvas width="750" height="750" id="canvas"></canvas>
    <div id="controlDiv">
        <b>Effective Resistance:</b>
        <div id="resEffMath">
            <math>
          
            </math>
        </div>
    </div>
</body>
<script src="ElectricalCircuitVisualizer.js" type="text/javascript"></script>
<script src="../Renderer.js" type="text/javascript"></script>
<script src="../util/DateUtil.js" type="text/javascript"></script>
<script src="../util/SIUtil.js" type="text/javascript"></script>
<script src="../util/ObjectUtil.js" type="text/javascript"></script>
<script src="../util/ColorUtil.js" type="text/javascript"></script>
<script src="../pageloader.js" type="text/javascript"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<script>
    let sim;
    let renderer;
    function resetSimulation() {

        if(sim != undefined) {
            sim.destroy();
            sim = undefined;
        }

        if(renderer != undefined) {
            renderer.destroy();
            renderer = undefined;
        }

        let canvas = document.getElementById("canvas");
        renderer = new Renderer(canvas, 30, 30);
        renderer.zoomAmount = 1;
        sim = new ElectricalCircuitVisualizer(renderer, this.updateUI);
    }

    function updateUI() {
        
        let effRes = sim.calculateEffectiveResistance();
        if(effRes != undefined) {
            document.getElementById("resEffMath").innerHTML = "<math><msub><mi>R</mi><mi>eff</mi></msub><mo>=</mo>" + sim.generateRefMathML(0) + "<mo>=</mo><mn>" + effRes + "Ω</mn></math>";
        }else {
            document.getElementById("resEffMath").innerHTML = "<math><msub><mi>R</mi><mi>eff</mi></msub><mo>=</mo><mi>Berechnung nicht möglich</mi></math>"
        }
        MathJax.typesetPromise()
    }
</script>
</html>